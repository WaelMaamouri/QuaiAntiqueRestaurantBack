name: my-symfony-app
type: php:8.2

# Commandes exécutées au build / déploiement
build:
    hooks:
        pre-deploy:
            - composer install --no-dev --optimize-autoloader
            - php bin/console cache:clear --env=prod
            - php bin/console cache:warmup --env=prod

# Variables d'environnement
variables:
    env:
        APP_ENV: prod
        APP_DEBUG: 0
        DATABASE_URL: "%env(DATABASE_URL)%"
        DEFAULT_URI: "https://main-bvxea6i-aofzto4ibqmv2.fr-3.platformsh.site"

# Point d'entrée web
web:
    public: true
    entrypoint: public/index.php

# Extensions PHP requises pour Symfony/Doctrine
runtime:
    extensions:
        - pdo
        - pdo_mysql
        - intl
