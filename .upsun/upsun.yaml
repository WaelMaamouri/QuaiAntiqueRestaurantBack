applications:
    app:
        type: "php:8.2"
        web:
            locations:
                "/":
                    root: "public"
                    passthru: "/index.php"
        build:
            flavor: none
        hooks:
            build: |
              composer install --no-dev --optimize-autoloader
              php bin/console cache:clear --env=prod
              php bin/console cache:warmup --env=prod
        dependencies:
            php:
                composer/composer: "^2"
        runtime:
            extensions:
                - mbstring
                - pdo
                - pdo_mysql
                - intl
                - opcache

        mounts:
            "/var":
                source: storage
                source_path: files
            "/vendor":
                source: storage
                source_path: files
        variables:
            php:
                display_errors: "Off"
            env:
                APP_ENV: prod
                APP_DEBUG: 0

services: {}

routes:
    "https://{default}/":
        type: upstream
        upstream: "app:http"
